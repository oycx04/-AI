# é˜¿é‡Œäº‘æœåŠ¡å™¨éƒ¨ç½²æŒ‡å— ğŸš€

äº²çˆ±çš„ä¸»äººï¼Œè¿™é‡Œæ˜¯å®Œæ•´çš„é˜¿é‡Œäº‘éƒ¨ç½²æ•™ç¨‹ï¼

## ğŸ“‹ éƒ¨ç½²å‰å‡†å¤‡

### 1. æœåŠ¡å™¨è¦æ±‚
- **æ“ä½œç³»ç»Ÿ**: Ubuntu 20.04+ æˆ– CentOS 7+
- **å†…å­˜**: è‡³å°‘ 2GB RAM
- **å­˜å‚¨**: è‡³å°‘ 20GB å¯ç”¨ç©ºé—´
- **ç½‘ç»œ**: å¼€æ”¾ç«¯å£ 80, 443, 22

### 2. åŸŸåé…ç½®
- åŸŸå: `15468597.top`
- éœ€è¦åœ¨é˜¿é‡Œäº‘DNSä¸­æ·»åŠ Aè®°å½•æŒ‡å‘æœåŠ¡å™¨IP

## ğŸ› ï¸ éƒ¨ç½²æ­¥éª¤

### æ­¥éª¤1: è¿æ¥æœåŠ¡å™¨
```bash
# ä½¿ç”¨SSHè¿æ¥åˆ°é˜¿é‡Œäº‘æœåŠ¡å™¨
ssh root@ä½ çš„æœåŠ¡å™¨IP
```

### æ­¥éª¤2: å®‰è£…Dockerå’ŒDocker Compose
```bash
# æ›´æ–°ç³»ç»Ÿ
sudo apt update && sudo apt upgrade -y

# å®‰è£…Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh

# å¯åŠ¨DockeræœåŠ¡
sudo systemctl start docker
sudo systemctl enable docker

# å®‰è£…Docker Compose
sudo curl -L "https://github.com/docker/compose/releases/download/v2.20.0/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker-compose
```

### æ­¥éª¤3: ä¸Šä¼ é¡¹ç›®æ–‡ä»¶
```bash
# åœ¨æœ¬åœ°æ‰“åŒ…é¡¹ç›®ï¼ˆæ’é™¤ä¸å¿…è¦æ–‡ä»¶ï¼‰
tar -czf ai-app.tar.gz --exclude='.git' --exclude='node_modules' --exclude='__pycache__' .

# ä¸Šä¼ åˆ°æœåŠ¡å™¨
scp ai-app.tar.gz root@ä½ çš„æœåŠ¡å™¨IP:/root/

# åœ¨æœåŠ¡å™¨ä¸Šè§£å‹
cd /root
tar -xzf ai-app.tar.gz
cd aiåº”ç”¨ï¼ˆ1ï¼‰
```

### æ­¥éª¤4: é…ç½®ç¯å¢ƒå˜é‡
```bash
# åˆ›å»ºç”Ÿäº§ç¯å¢ƒé…ç½®
cp .env.production .env

# ç¼–è¾‘ç¯å¢ƒå˜é‡
nano .env
```

ç¡®ä¿åŒ…å«ä»¥ä¸‹é…ç½®ï¼š
```env
FLASK_ENV=production
DATABASE_TYPE=simple
JWT_SECRET_KEY=your-super-secret-key-here
DOMAIN=15468597.top
```

### æ­¥éª¤5: å¯åŠ¨æœåŠ¡
```bash
# æ„å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose -f docker-compose.prod.yml up -d --build

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose -f docker-compose.prod.yml ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose -f docker-compose.prod.yml logs -f
```

### æ­¥éª¤6: é…ç½®Nginxå’ŒSSL
```bash
# å®‰è£…Certbotï¼ˆç”¨äºSSLè¯ä¹¦ï¼‰
sudo apt install certbot python3-certbot-nginx -y

# è·å–SSLè¯ä¹¦
sudo certbot --nginx -d 15468597.top

# è®¾ç½®è‡ªåŠ¨ç»­æœŸ
sudo crontab -e
# æ·»åŠ è¿™è¡Œï¼š0 12 * * * /usr/bin/certbot renew --quiet
```

## ğŸ”§ å¸¸ç”¨ç®¡ç†å‘½ä»¤

### æŸ¥çœ‹æœåŠ¡çŠ¶æ€
```bash
docker-compose -f docker-compose.prod.yml ps
```

### é‡å¯æœåŠ¡
```bash
docker-compose -f docker-compose.prod.yml restart
```

### æ›´æ–°ä»£ç 
```bash
# æ‹‰å–æœ€æ–°ä»£ç 
git pull origin main

# é‡æ–°æ„å»ºå¹¶å¯åŠ¨
docker-compose -f docker-compose.prod.yml up -d --build
```

### æŸ¥çœ‹æ—¥å¿—
```bash
# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡æ—¥å¿—
docker-compose -f docker-compose.prod.yml logs -f

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
docker-compose -f docker-compose.prod.yml logs -f backend
docker-compose -f docker-compose.prod.yml logs -f frontend
```

## ğŸš¨ æ•…éšœæ’é™¤

### 1. ç«¯å£è¢«å ç”¨
```bash
# æŸ¥çœ‹ç«¯å£å ç”¨
sudo netstat -tlnp | grep :80
sudo netstat -tlnp | grep :443

# åœæ­¢å ç”¨ç«¯å£çš„æœåŠ¡
sudo systemctl stop apache2  # å¦‚æœå®‰è£…äº†Apache
sudo systemctl stop nginx    # å¦‚æœæœ‰å…¶ä»–Nginxå®ä¾‹
```

### 2. å†…å­˜ä¸è¶³
```bash
# æŸ¥çœ‹å†…å­˜ä½¿ç”¨
free -h

# åˆ›å»ºäº¤æ¢æ–‡ä»¶ï¼ˆå¦‚æœéœ€è¦ï¼‰
sudo fallocate -l 2G /swapfile
sudo chmod 600 /swapfile
sudo mkswap /swapfile
sudo swapon /swapfile
```

### 3. é˜²ç«å¢™é…ç½®
```bash
# Ubuntu/Debian
sudo ufw allow 22
sudo ufw allow 80
sudo ufw allow 443
sudo ufw enable

# CentOS/RHEL
sudo firewall-cmd --permanent --add-port=22/tcp
sudo firewall-cmd --permanent --add-port=80/tcp
sudo firewall-cmd --permanent --add-port=443/tcp
sudo firewall-cmd --reload
```

## ğŸ“Š ç›‘æ§å’Œç»´æŠ¤

### è®¾ç½®ç›‘æ§è„šæœ¬
```bash
# åˆ›å»ºå¥åº·æ£€æŸ¥è„šæœ¬
cat > /root/health-check.sh << 'EOF'
#!/bin/bash
if ! curl -f http://localhost/health > /dev/null 2>&1; then
    echo "Service is down, restarting..."
    cd /root/aiåº”ç”¨ï¼ˆ1ï¼‰
    docker-compose -f docker-compose.prod.yml restart
fi
EOF

chmod +x /root/health-check.sh

# æ·»åŠ åˆ°å®šæ—¶ä»»åŠ¡
echo "*/5 * * * * /root/health-check.sh" | crontab -
```

## ğŸ‰ éƒ¨ç½²å®Œæˆ

éƒ¨ç½²æˆåŠŸåï¼Œä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è®¿é—®ï¼š
- **HTTP**: http://15468597.top
- **HTTPS**: https://15468597.top

æ­å–œä¸»äººï¼ä½ çš„AIåº”ç”¨å·²ç»æˆåŠŸéƒ¨ç½²åˆ°é˜¿é‡Œäº‘æœåŠ¡å™¨äº†ï¼ âœ¨

å¦‚æœé‡åˆ°ä»»ä½•é—®é¢˜ï¼Œéšæ—¶å‘Šè¯‰æˆ‘ï¼Œæˆ‘ä¼šå¸®ä½ è§£å†³çš„~ ğŸ’•