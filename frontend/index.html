<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å·ç‹AI</title>
    <script src="https://cdn.tailwindcss.com/3.3.3"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">
    
    <!-- å¹¿å‘Šè”ç›Ÿé€šç”¨é…ç½® -->
    <meta name="keywords" content="è€ƒç ”,å¤è¯»,å­¦ä¹ ,è¾…å¯¼,åœ¨çº¿æ•™è‚²,åŸ¹è®­">
    <meta name="description" content="ä¸“ä¸šçš„å­¦ä¹ åŠ©æ‰‹å¹³å°ï¼Œæä¾›è€ƒç ”è¾…å¯¼ã€å¤è¯»æŒ‡å¯¼ç­‰ä¼˜è´¨æ•™è‚²æœåŠ¡">
    
    <!-- Google Analytics 4 -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        // é…ç½®å°†åœ¨é¡µé¢åŠ è½½åè¿›è¡Œ
    </script>
    
    <!-- ç»Ÿè®¡é…ç½®æ–‡ä»¶ -->
    <script src="analytics-config.js"></script>
    
    <!-- ç™¾åº¦ç»Ÿè®¡ -->
    <script>
        var _hmt = _hmt || [];
        (function() {
            // ä»é…ç½®æ–‡ä»¶è·å–ç™¾åº¦ç»Ÿè®¡ID
            var baiduId = window.ANALYTICS_CONFIG && window.ANALYTICS_CONFIG.baidu.enabled ? 
                         window.ANALYTICS_CONFIG.baidu.siteId : 'YOUR_BAIDU_ANALYTICS_ID';
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?" + baiduId;
            var s = document.getElementsByTagName("script")[0]; 
            s.parentNode.insertBefore(hm, s);
        })();
    </script>
    
    <!-- å¹¿å‘Šå±è”½æ£€æµ‹ -->
    <script>
        // å¹¿å‘Šå±è”½æ£€æµ‹
        window.adBlockDetected = false;
        
        function detectAdBlock() {
            var testAd = document.createElement('div');
            testAd.innerHTML = '&nbsp;';
            testAd.className = 'adsbox';
            testAd.style.position = 'absolute';
            testAd.style.left = '-10000px';
            document.body.appendChild(testAd);
            
            setTimeout(function() {
                if (testAd.offsetHeight === 0) {
                    window.adBlockDetected = true;
                    showAdBlockNotice();
                }
                document.body.removeChild(testAd);
            }, 100);
        }
        
        function showAdBlockNotice() {
            // æ£€æŸ¥æ˜¯å¦å·²ç»æ˜¾ç¤ºè¿‡æç¤º
            if (localStorage.getItem('adblock_notice_shown') === 'true') {
                return;
            }
            
            var notice = document.createElement('div');
            notice.id = 'adblock-notice';
            notice.innerHTML = `
                <div class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4" style="backdrop-filter: blur(5px);">
                    <div class="bg-white rounded-2xl shadow-2xl max-w-md w-full transform transition-all duration-300 scale-95 hover:scale-100">
                        <div class="p-6 text-center">
                            <div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-yellow-100 mb-4">
                                <svg class="h-6 w-6 text-yellow-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z" />
                                </svg>
                            </div>
                            <h3 class="text-lg font-semibold text-gray-900 mb-2">æ£€æµ‹åˆ°å¹¿å‘Šå±è”½æ’ä»¶ ğŸ›¡ï¸</h3>
                            <p class="text-gray-600 mb-6 leading-relaxed">äº²çˆ±çš„ç”¨æˆ·ï¼Œæˆ‘ä»¬å‘ç°æ‚¨ä½¿ç”¨äº†å¹¿å‘Šå±è”½æ’ä»¶ã€‚<br>å¹¿å‘Šæ”¶å…¥æ˜¯æˆ‘ä»¬ç»´æŒç½‘ç«™è¿è¥çš„é‡è¦æ”¯æŒï¼Œ<br>è¯·è€ƒè™‘å°†æœ¬ç«™åŠ å…¥ç™½åå•ï¼Œæ„Ÿè°¢æ‚¨çš„ç†è§£ï¼</p>
                            <div class="flex flex-col sm:flex-row gap-3">
                                <button onclick="closeAdBlockNotice(false)" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200">
                                    æˆ‘çŸ¥é“äº†
                                </button>
                                <button onclick="closeAdBlockNotice(true)" class="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-2 px-4 rounded-lg transition-colors duration-200">
                                    ä¸å†æé†’
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(notice);
            
            // æ·»åŠ åŠ¨ç”»æ•ˆæœ
            setTimeout(function() {
                var modal = notice.querySelector('div > div');
                modal.classList.remove('scale-95');
                modal.classList.add('scale-100');
            }, 10);
        }
        
        function closeAdBlockNotice(dontShowAgain) {
            var notice = document.getElementById('adblock-notice');
            if (notice) {
                var modal = notice.querySelector('div > div');
                modal.classList.add('scale-95');
                setTimeout(function() {
                    notice.remove();
                }, 200);
            }
            
            if (dontShowAgain) {
                localStorage.setItem('adblock_notice_shown', 'true');
            }
        }
        
        // å¹¿å‘ŠåŠ è½½ä¼˜åŒ–
        function initAds() {
            // æ·»åŠ åŠ è½½åŠ¨ç”»
            const adElements = document.querySelectorAll('[id$="-ad"]');
            adElements.forEach(ad => {
                ad.classList.add('ad-loading');
                
                // æ¨¡æ‹Ÿå¹¿å‘ŠåŠ è½½å®Œæˆ
                setTimeout(() => {
                    ad.classList.remove('ad-loading');
                }, 1500);
            });
            
            // å¹¿å‘Šç‚¹å‡»ç»Ÿè®¡
            adElements.forEach(ad => {
                ad.addEventListener('click', function() {
                    if (typeof gtag !== 'undefined') {
                        gtag('event', 'ad_click', {
                            'ad_position': this.id,
                            'event_category': 'advertisement'
                        });
                    }
                });
            });
        }
        
        // ç½‘ç«™ç»Ÿè®¡åˆå§‹åŒ–
        function initAnalytics() {
            const config = window.ANALYTICS_CONFIG;
            if (!config) return;
            
            // Google Analytics 4
            if (config.google.enabled && typeof gtag !== 'undefined') {
                gtag('config', config.google.measurementId, {
                    page_title: document.title,
                    page_location: window.location.href,
                    anonymize_ip: config.privacy.anonymizeIP
                });
                
                // è‡ªå®šä¹‰äº‹ä»¶è¿½è¸ª
                gtag('event', 'page_view', {
                    page_title: document.title,
                    page_location: window.location.href,
                    user_agent: navigator.userAgent
                });
            }
            
            // ç™¾åº¦ç»Ÿè®¡
            if (config.baidu.enabled && typeof _hmt !== 'undefined') {
                _hmt.push(['_trackPageview']);
            }
            
            // æ£€æŸ¥Do Not Trackè®¾ç½®
            if (config.privacy.respectDNT && navigator.doNotTrack === '1') {
                console.log('ç”¨æˆ·å¯ç”¨äº†Do Not Trackï¼Œè·³è¿‡ç»Ÿè®¡è¿½è¸ª');
                return;
            }
        }
        
        // ç”¨æˆ·è¡Œä¸ºè¿½è¸ª
        function trackUserBehavior() {
            const config = window.ANALYTICS_CONFIG;
            if (!config || !config.tracking) return;
            
            // æ£€æŸ¥Do Not Track
            if (config.privacy.respectDNT && navigator.doNotTrack === '1') {
                return;
            }
            
            // ç‚¹å‡»äº‹ä»¶è¿½è¸ª
            if (config.tracking.trackClicks) {
                document.addEventListener('click', function(e) {
                    // è®¡ç®—å™¨ä½¿ç”¨è¿½è¸ª
                    if (e.target.matches('.calculator-btn, .calc-btn')) {
                        if (config.google.enabled && typeof gtag !== 'undefined') {
                            gtag('event', 'calculator_use', {
                                event_category: config.events.calculator_use.category,
                                event_label: e.target.textContent || e.target.value,
                                value: 1
                            });
                        }
                        
                        if (config.baidu.enabled && typeof _hmt !== 'undefined') {
                            _hmt.push(['_trackEvent', config.events.calculator_use.category, 'calculator_use', e.target.textContent || e.target.value]);
                        }
                    }
                    
                    // åŠŸèƒ½æŒ‰é’®ç‚¹å‡»è¿½è¸ª
                    if (e.target.matches('.feature-btn, .tool-btn')) {
                        if (config.google.enabled && typeof gtag !== 'undefined') {
                            gtag('event', 'feature_click', {
                                event_category: config.events.feature_click.category,
                                event_label: e.target.textContent || e.target.getAttribute('data-feature'),
                                value: 1
                            });
                        }
                        
                        if (config.baidu.enabled && typeof _hmt !== 'undefined') {
                            _hmt.push(['_trackEvent', config.events.feature_click.category, 'feature_click', e.target.textContent || e.target.getAttribute('data-feature')]);
                        }
                    }
                    
                    // å¤–éƒ¨é“¾æ¥è¿½è¸ª
                    if (config.tracking.trackExternalLinks && e.target.tagName === 'A') {
                        const href = e.target.href;
                        if (href && !href.includes(window.location.hostname)) {
                            if (config.google.enabled && typeof gtag !== 'undefined') {
                                gtag('event', 'click', {
                                    event_category: 'outbound',
                                    event_label: href,
                                    transport_type: 'beacon'
                                });
                            }
                        }
                    }
                });
            }
            
            // é¡µé¢åœç•™æ—¶é—´è¿½è¸ª
            let startTime = Date.now();
            window.addEventListener('beforeunload', function() {
                let timeSpent = Math.round((Date.now() - startTime) / 1000);
                if (typeof gtag !== 'undefined' && timeSpent > 5) {
                    gtag('event', 'timing_complete', {
                        name: 'page_view_time',
                        value: timeSpent
                    });
                }
            });
            
            // æ»šåŠ¨æ·±åº¦è¿½è¸ª
            let maxScroll = 0;
            window.addEventListener('scroll', function() {
                let scrollPercent = Math.round((window.scrollY / (document.body.scrollHeight - window.innerHeight)) * 100);
                if (scrollPercent > maxScroll && scrollPercent % 25 === 0) {
                    maxScroll = scrollPercent;
                    if (typeof gtag !== 'undefined') {
                        gtag('event', 'scroll', {
                            event_category: 'engagement',
                            event_label: scrollPercent + '%',
                            value: scrollPercent
                        });
                    }
                }
            });
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåæ£€æµ‹
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(detectAdBlock, 2000);
            initAds();
            initAnalytics();
            trackUserBehavior();
        });
        
        // å¹¿å‘Šä½æ‡’åŠ è½½ä¼˜åŒ–
        if ('IntersectionObserver' in window) {
            const adObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        // å¹¿å‘Šè¿›å…¥è§†å£æ—¶çš„å¤„ç†
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                    }
                });
            }, { threshold: 0.1 });
            
            document.addEventListener('DOMContentLoaded', function() {
                document.querySelectorAll('.ad-container, [id$="-ad"]').forEach(ad => {
                    ad.style.opacity = '0';
                    ad.style.transform = 'translateY(20px)';
                    ad.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
                    adObserver.observe(ad);
                });
            });
        }
    </script>
    
    <!-- MathJaxæ”¯æŒ -->
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['\\(', '\\)'], ['$', '$']],
                displayMath: [['\\[', '\\]'], ['$$', '$$']]
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
            }
        };
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap');
        
        body {
            font-family: 'Nunito', sans-serif;
            background-color: #f5f9fc;
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zm-6 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zm29 22c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM32 63c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zm57-13c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23e1e8ed' fill-opacity='0.2' fill-rule='evenodd'/%3E%3C/svg%3E");
        }
        
        .chat-container {
            background-color: white;
            background-image: linear-gradient(to bottom, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0.9) 100%), url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zm-6 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zm29 22c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM32 63c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zm57-13c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23e1e8ed' fill-opacity='0.2' fill-rule='evenodd'/%3E%3C/svg%3E");
            border-radius: 16px;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
        }
        
        .ai-message {
            background-color: #e3f2fd;
            border-radius: 18px 18px 18px 4px;
            color: #1976d2;
        }
        
        .user-message {
            background-color: #4caf50;
            color: white;
            border-radius: 18px 18px 4px 18px;
        }
        
        /* å¹¿å‘Šä½å“åº”å¼ä¼˜åŒ– */
        @media (max-width: 1024px) {
            #left-banner-ad,
            #sidebar-ad {
                display: none; /* å¹³æ¿å’Œç§»åŠ¨ç«¯éšè—å·¦å³ä¾§å¹¿å‘Š */
            }
        }
        
        @media (max-width: 768px) {
            .ad-container {
                width: 100% !important;
                max-width: 300px;
                margin: 0 auto;
            }
            
            #bottom-banner-ad {
                padding: 8px !important;
            }
            
            /* ç§»åŠ¨ç«¯è°ƒæ•´ä¸»è¦å†…å®¹åŒºåŸŸè¾¹è· */
            .pt-32.p-4.pl-48 {
                padding-left: 1rem !important;
            }
        }
        
        /* ç¡®ä¿å¹¿å‘Šä½ä¸ä¼šé®æŒ¡ä¸»è¦å†…å®¹ */
        @media (min-width: 1025px) {
            .main-content {
                margin-left: 180px;
                margin-right: 180px;
            }
        }
        
        @media (max-width: 480px) {
            .ad-container {
                max-width: 250px;
            }
        }
        
        /* å¹¿å‘Šä½æ‚¬åœæ•ˆæœ */
        .ad-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            transition: all 0.3s ease;
        }
        
        /* å¹¿å‘ŠåŠ è½½åŠ¨ç”» */
        .ad-loading {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }
        
        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        
        .input-area {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        .send-btn {
            background-color: #2196f3;
            color: white;
            transition: all 0.2s ease;
        }
        
        .send-btn:hover {
            background-color: #1976d2;
            transform: translateY(-2px);
        }
        
        .campus-icon {
            color: #4caf50;
        }
        
        .header {
            background: linear-gradient(135deg, #2196f3 0%, #4caf50 100%);
            color: white;
        }
        
        .decoration {
            position: absolute;
            opacity: 0.1;
            z-index: -1;
        }
        
        .decoration.book {
            color: #2196f3;
        }
        
        .decoration.pencil {
            color: #ff9800;
        }
        
        .decoration.building {
            color: #4caf50;
        }
        
        .progress-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }
        
        .progress-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }
        
        /* æ–°å¢æ ·å¼ */
        .overview-stats {
            display: flex;
            gap: 12px;
            margin-top: 12px;
            flex-wrap: wrap;
        }
        
        .difficulty-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .difficulty-badge.beginner {
            background: #d1fae5;
            color: #065f46;
        }
        
        .difficulty-badge.intermediate {
            background: #fef3c7;
            color: #92400e;
        }
        
        .difficulty-badge.advanced {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .success-metrics {
            margin-top: 16px;
            padding: 16px;
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border-radius: 12px;
            border-left: 4px solid #0ea5e9;
        }
        
        .learning-objectives {
            margin: 16px 0;
            padding: 16px;
            background: #f8fafc;
            border-radius: 8px;
            border-left: 3px solid #3b82f6;
        }
        
        .objectives-list {
            margin: 8px 0;
            padding-left: 20px;
        }
        
        .objectives-list li {
            margin: 4px 0;
            color: #475569;
        }
        
        .resource-meta {
            display: flex;
            gap: 8px;
            margin-top: 8px;
        }
        
        .time-badge {
            padding: 2px 8px;
            background: #dbeafe;
            color: #1e40af;
            border-radius: 12px;
            font-size: 11px;
        }
        
        .milestone-section {
            margin: 16px 0;
            padding: 16px;
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
            border-radius: 8px;
            border-left: 3px solid #f59e0b;
        }
        
        .tips-section {
            margin: 16px 0;
            padding: 16px;
            background: linear-gradient(135deg, #f0f9ff 0%, #dbeafe 100%);
            border-radius: 8px;
            border-left: 3px solid #3b82f6;
        }
        
        .next-steps-section {
            margin: 24px 0;
            padding: 20px;
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
            border-radius: 12px;
            border: 2px solid #22c55e;
        }
        
        .resource-item {
            transition: all 0.3s ease;
        }
        
        .resource-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        /* æ€è€ƒè¿‡ç¨‹æ ·å¼ */
        .thinking-process {
            margin: 20px 0;
            padding: 20px;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-radius: 12px;
            border: 1px solid #cbd5e1;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .thinking-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 2px solid #e2e8f0;
        }
        
        .thinking-header h3 {
            margin: 0;
            color: #1e293b;
            font-size: 18px;
            font-weight: 600;
        }
        
        .thinking-indicator {
            display: flex;
            gap: 4px;
        }
        
        .thinking-indicator .dot {
            width: 8px;
            height: 8px;
            background: #3b82f6;
            border-radius: 50%;
            animation: thinking-pulse 1.5s infinite;
        }
        
        .thinking-indicator .dot:nth-child(2) {
            animation-delay: 0.3s;
        }
        
        .thinking-indicator .dot:nth-child(3) {
            animation-delay: 0.6s;
        }
        
        @keyframes thinking-pulse {
            0%, 60%, 100% {
                transform: scale(1);
                opacity: 0.7;
            }
            30% {
                transform: scale(1.2);
                opacity: 1;
            }
        }
        
        .thinking-content {
            max-height: 300px;
            overflow-y: auto;
            padding-right: 8px;
        }
        
        .thinking-step {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin: 12px 0;
            padding: 12px;
            background: white;
            border-radius: 8px;
            border-left: 3px solid #3b82f6;
            animation: step-appear 0.5s ease-out;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .thinking-step.complete {
            border-left-color: #22c55e;
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
        }
        
        .step-icon {
            font-size: 16px;
            flex-shrink: 0;
            margin-top: 2px;
        }
        
        .step-text {
            color: #374151;
            font-size: 14px;
            line-height: 1.5;
            flex: 1;
        }
        
        @keyframes step-appear {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* æ»šåŠ¨æ¡æ ·å¼ */
        .thinking-content::-webkit-scrollbar {
            width: 6px;
        }
        
        .thinking-content::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 3px;
        }
        
        .thinking-content::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 3px;
        }
        
        .thinking-content::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
        
        /* é€šçŸ¥æ¶ˆæ¯æ ·å¼ */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            max-width: 400px;
            z-index: 1000;
            border-radius: 12px;
            padding: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
            backdrop-filter: blur(10px);
            animation: slideInRight 0.3s ease-out;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .notification.error {
            background: rgba(254, 226, 226, 0.95);
            border: 1px solid #fca5a5;
            color: #dc2626;
        }
        
        .notification.success {
            background: rgba(220, 252, 231, 0.95);
            border: 1px solid #86efac;
            color: #16a34a;
        }
        
        .notification .close-btn {
            background: none;
            border: none;
            font-size: 18px;
            cursor: pointer;
            opacity: 0.7;
            transition: opacity 0.2s;
            margin-left: auto;
        }
        
        .notification .close-btn:hover {
            opacity: 1;
        }
        
        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        /* æŒ‰é’®ç¦ç”¨çŠ¶æ€ */
        .generate-btn:disabled {
            background: #9ca3af !important;
            cursor: not-allowed;
            transform: none !important;
            opacity: 0.7;
        }
        
        .generate-btn:disabled:hover {
            background: #9ca3af !important;
            transform: none !important;
        }

    </style>
</head>
<body class="min-h-screen">
    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <nav class="fixed top-0 left-0 right-0 z-50 bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 shadow-lg">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 rounded-full bg-white flex items-center justify-center text-blue-600">
                        <i class="fas fa-graduation-cap text-xl"></i>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold text-white">AIåŠ©æ‰‹å¹³å°</h1>
                        <p class="text-sm text-white opacity-80">æ™ºèƒ½å­¦ä¹ ä¸åˆ›ä½œåŠ©æ‰‹</p>
                    </div>
                </div>
                
                <!-- é¡µé¢åˆ‡æ¢å¯¼èˆª -->
                <div class="flex items-center space-x-4">
                    <button onclick="window.location.href='index.html'" class="nav-btn active px-6 py-3 rounded-xl font-semibold transition-all duration-300 bg-white bg-opacity-20 text-white hover:bg-opacity-30">
                        <i class="fas fa-comments mr-2"></i>å·ç‹AI
                    </button>
                    <button onclick="window.location.href='simple-ai.html'" class="nav-btn px-6 py-3 rounded-xl font-semibold transition-all duration-300 text-white hover:bg-white hover:bg-opacity-20">
                        <i class="fas fa-palette mr-2"></i>AIç”»å¸ˆåŠ©æ‰‹
                    </button>
                    <button onclick="window.location.href='learning-path-generator.html'" class="nav-btn px-6 py-3 rounded-xl font-semibold transition-all duration-300 text-white hover:bg-white hover:bg-opacity-20">
                        <i class="fas fa-route mr-2"></i>å­¦ä¹ è·¯å¾„ç”Ÿæˆå™¨
                    </button>
                    <button onclick="window.location.href='leaderboard.html'" class="nav-btn px-6 py-3 rounded-xl font-semibold transition-all duration-300 text-white hover:bg-white hover:bg-opacity-20">
                        <i class="fas fa-trophy mr-2"></i>å·ç‹æ’å
                    </button>
                    
                    <!-- åˆ†éš”çº¿ -->
                    <div class="w-px h-8 bg-white bg-opacity-30 mx-2"></div>
                    
                    <!-- ç”¨æˆ·åŠŸèƒ½ -->
                    <button onclick="window.location.href='auth.html'" class="px-4 py-2 rounded-lg font-medium transition-all duration-300 bg-blue-500 hover:bg-blue-600 text-white">
                        <i class="fas fa-sign-in-alt mr-2"></i>ç™»å½•
                    </button>
                    <button onclick="window.location.href='auth.html'" class="px-4 py-2 rounded-lg font-medium transition-all duration-300 bg-green-500 hover:bg-green-600 text-white">
                        <i class="fas fa-user-plus mr-2"></i>æ³¨å†Œ
                    </button>
                </div>
                

            </div>
        </div>
    </nav>

    <!-- æ ¡å›­è£…é¥°å…ƒç´  -->
    <i class="fas fa-book decoration book text-8xl top-10 left-10"></i>
    <i class="fas fa-pencil-alt decoration pencil text-6xl bottom-20 right-10"></i>
    <i class="fas fa-school decoration building text-9xl bottom-10 left-1/4"></i>
    
    <!-- å·¦ä¾§æ‚¬æµ®å¹¿å‘Šä½ -->
    <div class="fixed left-4 top-1/2 transform -translate-y-1/2 z-30">
        <div id="left-banner-ad" class="bg-white rounded-lg shadow-xl border border-gray-200 p-2 w-36 hover:shadow-2xl transition-shadow duration-300 ad-hover">
            <!-- ç™¾åº¦è”ç›Ÿå¹¿å‘Šä»£ç ä½ç½® -->
            <script type="text/javascript">
                // ç™¾åº¦è”ç›Ÿå¹¿å‘Šä»£ç 
                /*
                (function() {
                    var cpro_id = "u6849608"; // æ›¿æ¢ä¸ºå®é™…çš„ç™¾åº¦è”ç›ŸID
                    var cpro_w = 140;
                    var cpro_h = 280;
                    var s = document.createElement("script");
                    s.type = "text/javascript";
                    s.charset = "UTF-8";
                    s.src = "//cpro.baidustatic.com/cpro/ui/c.js";
                    document.getElementsByTagName("head")[0].appendChild(s);
                })();
                */
            </script>
            <!-- ä¸´æ—¶å ä½å†…å®¹ -->
            <div class="text-center text-gray-500 py-4">
                <i class="fas fa-graduation-cap text-2xl mb-2 block text-blue-500"></i>
                <p class="text-xs font-medium mb-2">ğŸ“ è€ƒç ”åŸ¹è®­</p>
                <p class="text-xs mb-2">ğŸ“š åœ¨çº¿è¾…å¯¼</p>
                <p class="text-xs mb-2">ğŸš€ æå‡å­¦å†</p>
                <p class="text-xs opacity-70">140x280 å¹¿å‘Šä½</p>
            </div>
        </div>
    </div>

    <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
    <div class="pt-32 p-4 flex items-center justify-center min-h-screen">
        <div class="content-container w-full max-w-6xl mx-auto">
        <div class="w-full max-w-4xl mx-auto" id="chatContent">
        <!-- èŠå¤©å¤´éƒ¨ -->
        <div class="header rounded-t-2xl p-4 flex items-center justify-center">
            <div class="flex items-center space-x-3">
                <div class="w-10 h-10 rounded-full bg-white flex items-center justify-center text-green-500">
                    <i class="fas fa-graduation-cap text-xl"></i>
                </div>
                <div>
                    <h2 class="text-xl font-bold">å¼€å§‹å­¦ä¹ å¯¹è¯</h2>
                    <p class="text-sm opacity-80">æœ‰ä»€ä¹ˆé—®é¢˜å°½ç®¡é—®æˆ‘</p>
                </div>
            </div>
        </div>
        
        <!-- èŠå¤©åŒºåŸŸ -->
        <div id="chatMessages" class="chat-container p-4 h-96 overflow-y-auto flex flex-col">
            <!-- AIåˆå§‹æ¶ˆæ¯ -->
            <div class="flex mb-4">
                <div class="w-8 h-8 rounded-full bg-blue-500 flex items-center justify-center text-white mr-2">
                    <img src="assets/cute_dog_anime.png" alt="AIåŠ©æ‰‹" class="w-6 h-6 rounded-full">
                </div>
                <div class="max-w-xs md:max-w-md">
                    <div class="ai-message p-3">
                        <p>å—¨ï¼ŒåŒå­¦ï¼æœ‰ä»€ä¹ˆå­¦ä¹ é—®é¢˜æƒ³èŠä¸€èŠå—ï¼ŸğŸ˜Š</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- è¾“å…¥åŒºåŸŸ -->
        <div class="input-area p-3 flex items-center space-x-2">
            <input type="text" id="chatInput" placeholder="è¾“å…¥ä½ çš„é—®é¢˜..." class="flex-1 p-2 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-300" onkeypress="handleChatKeyPress(event)">
            <button class="send-btn p-2 rounded-lg w-10 h-10 flex items-center justify-center" onclick="sendChatMessage()">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
        
        <!-- å­¦ä¹ å·¥å…·åŒºåŸŸ -->
        <div class="mt-8 flex gap-8 justify-center">
            <!-- å·¦ä¾§åŠŸèƒ½åŒº -->
            <div class="flex-1 max-w-md space-y-6">
                <!-- å­¦ä¹ è®¡æ—¶å™¨ -->
                <div class="bg-white rounded-xl p-4 shadow-lg border border-gray-100 hover:shadow-xl transition-shadow duration-300">
                    <div class="flex items-center mb-3">
                        <div class="bg-blue-100 p-2 rounded-lg mr-3">
                            <i class="fas fa-clock text-blue-600 text-lg"></i>
                        </div>
                        <h3 class="font-bold text-gray-800">å­¦ä¹ è®¡æ—¶å™¨</h3>
                    </div>
                    <div class="text-center">
                        <div id="timer-display" class="text-3xl font-mono text-gray-800 mb-4 bg-gray-50 rounded-lg py-2">00:00:00</div>
                        <div class="flex gap-2 justify-center">
                            <button id="start-timer" class="px-4 py-2 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg text-sm hover:from-green-600 hover:to-green-700 transition-all duration-200 shadow-md hover:shadow-lg">
                                <i class="fas fa-play mr-1"></i>å¼€å§‹
                            </button>
                            <button id="pause-timer" class="px-4 py-2 bg-gradient-to-r from-yellow-500 to-yellow-600 text-white rounded-lg text-sm hover:from-yellow-600 hover:to-yellow-700 transition-all duration-200 shadow-md hover:shadow-lg">
                                <i class="fas fa-pause mr-1"></i>æš‚åœ
                            </button>
                            <button id="reset-timer" class="px-4 py-2 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg text-sm hover:from-red-600 hover:to-red-700 transition-all duration-200 shadow-md hover:shadow-lg">
                                <i class="fas fa-stop mr-1"></i>é‡ç½®
                            </button>
                        </div>
                    </div>
                </div>

                <!-- ä»Šæ—¥å­¦ä¹ ç»Ÿè®¡ -->
                <div class="bg-white rounded-xl p-4 shadow-lg border border-gray-100 hover:shadow-xl transition-shadow duration-300">
                    <div class="flex items-center mb-3">
                        <div class="bg-green-100 p-2 rounded-lg mr-3">
                            <i class="fas fa-chart-line text-green-600 text-lg"></i>
                        </div>
                        <h3 class="font-bold text-gray-800">ä»Šæ—¥å­¦ä¹ </h3>
                    </div>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center p-2 bg-blue-50 rounded-lg">
                            <span class="text-sm text-gray-700 font-medium">å­¦ä¹ æ—¶é•¿</span>
                            <span id="total-study-time" class="font-bold text-blue-600">0åˆ†é’Ÿ</span>
                        </div>
                        <div class="flex justify-between items-center p-2 bg-green-50 rounded-lg">
                            <span class="text-sm text-gray-700 font-medium">æé—®æ¬¡æ•°</span>
                            <span id="question-count" class="font-bold text-green-600">0æ¬¡</span>
                        </div>
                        <div class="bg-purple-50 p-3 rounded-lg">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-sm text-gray-700 font-medium">å­¦ä¹ ç›®æ ‡</span>
                            </div>
                            <div class="flex items-center space-x-2 mb-2">
                                <select id="hours" class="text-sm font-semibold text-purple-600 bg-white border border-purple-300 rounded-lg px-3 py-1 focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-200">
                                    <option value="0">0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                </select>
                                <span class="text-sm text-gray-600">å°æ—¶</span>
                                <select id="minutes" class="text-sm font-semibold text-purple-600 bg-white border border-purple-300 rounded-lg px-3 py-1 focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-200">
                                    <option value="0">0</option>
                                    <option value="15">15</option>
                                    <option value="30">30</option>
                                    <option value="45">45</option>
                                </select>
                                <span class="text-sm text-gray-600">åˆ†é’Ÿ</span>
                            </div>
                            <div class="flex justify-between items-center text-xs text-gray-600 mb-2">
                                <span id="timer-status" class="font-medium">æœªå¼€å§‹</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-3 overflow-hidden">
                                <div id="progress-bar" class="bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 h-3 rounded-full transition-all duration-500 ease-out" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>



            <!-- å³ä¾§åŠŸèƒ½åŒº -->
            <div class="flex-1 max-w-md space-y-6">
                <!-- å¾…åŠäº‹æƒ… -->
                <div class="bg-white rounded-xl p-4 shadow-lg border border-gray-100 hover:shadow-xl transition-shadow duration-300">
                    <div class="flex items-center mb-3">
                        <div class="bg-pink-100 p-2 rounded-lg mr-3">
                            <i class="fas fa-tasks text-pink-600 text-lg"></i>
                        </div>
                        <h3 class="font-bold text-gray-800">å¾…åŠäº‹æƒ…</h3>
                    </div>
                    <div class="space-y-3">
                        <!-- æ·»åŠ æ–°ä»»åŠ¡ -->
                        <div class="flex gap-2">
                            <input type="text" id="new-todo-input" placeholder="è¾“å…¥ä»Šå¤©è¦å®Œæˆçš„ä»»åŠ¡..." class="flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:border-pink-500 focus:ring-2 focus:ring-pink-200">
                            <button id="add-todo-btn" class="px-3 py-2 bg-gradient-to-r from-pink-500 to-pink-600 text-white rounded-lg text-sm hover:from-pink-600 hover:to-pink-700 transition-all duration-200 shadow-md hover:shadow-lg">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                        
                        <!-- ä»»åŠ¡åˆ—è¡¨ -->
                        <div id="todo-list" class="space-y-2 max-h-48 overflow-y-auto">
                            <!-- ä»»åŠ¡å°†åŠ¨æ€æ·»åŠ åˆ°è¿™é‡Œ -->
                        </div>
                        
                        <!-- ç»Ÿè®¡ä¿¡æ¯ -->
                        <div class="flex justify-between items-center pt-2 border-t border-gray-200">
                            <span class="text-xs text-gray-600">ä»Šæ—¥è¿›åº¦</span>
                            <span id="todo-progress" class="text-xs font-semibold text-pink-600">0/2 å®Œæˆ</span>
                        </div>
                    </div>
                </div>

                <!-- å­¦ä¹ æé†’ -->
                <div class="bg-white rounded-xl p-4 shadow-lg border border-gray-100">
                    <div class="flex items-center mb-3">
                        <i class="fas fa-bell text-orange-500 text-xl mr-2"></i>
                        <h3 class="font-semibold text-gray-800">å­¦ä¹ æé†’</h3>
                    </div>
                    <div class="space-y-2">
                        <div class="flex items-center justify-between">
                            <span class="text-sm text-gray-600">ä¼‘æ¯æé†’</span>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" id="break-reminder" class="sr-only peer">
                                <div class="w-9 h-5 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600"></div>
                            </label>
                        </div>
                        <div class="flex items-center justify-between">
                            <span class="text-sm text-gray-600">æ¯æ—¥ç›®æ ‡</span>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" id="daily-goal" class="sr-only peer" checked>
                                <div class="w-9 h-5 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600"></div>
                            </label>
                        </div>
                        <button class="w-full mt-2 px-3 py-2 bg-orange-500 text-white rounded-lg text-sm hover:bg-orange-600 transition-colors">
                            <i class="fas fa-cog mr-1"></i>è®¾ç½®æé†’
                        </button>
                    </div>
                </div>
            </div>


        </div>

        <!-- å¿«é€ŸåŠŸèƒ½åŒºåŸŸ -->
        <div class="mt-8 bg-white rounded-xl p-8 shadow-lg border border-gray-100 max-w-4xl mx-auto">
            <h3 class="text-xl font-semibold text-gray-800 mb-6 flex items-center justify-center">
                <i class="fas fa-magic text-purple-500 mr-2"></i>
                å¿«é€ŸåŠŸèƒ½
            </h3>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 max-w-3xl mx-auto">
                <button class="quick-function-btn p-4 rounded-lg border-2 border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all duration-200 text-center group" data-function="calculator">
                    <i class="fas fa-calculator text-3xl text-blue-500 mb-3 group-hover:scale-110 transition-transform"></i>
                    <div class="text-base font-medium text-gray-700">è®¡ç®—å™¨</div>
                </button>
                <button class="quick-function-btn p-4 rounded-lg border-2 border-gray-200 hover:border-green-300 hover:bg-green-50 transition-all duration-200 text-center group" data-function="translator">
                    <i class="fas fa-language text-3xl text-green-500 mb-3 group-hover:scale-110 transition-transform"></i>
                    <div class="text-base font-medium text-gray-700">ç¿»è¯‘åŠ©æ‰‹</div>
                </button>
                <button class="quick-function-btn p-4 rounded-lg border-2 border-gray-200 hover:border-red-300 hover:bg-red-50 transition-all duration-200 text-center group" data-function="creative">
                    <i class="fas fa-lightbulb text-3xl text-red-500 mb-3 group-hover:scale-110 transition-transform"></i>
                    <div class="text-base font-medium text-gray-700">åˆ›æ„çµæ„Ÿ</div>
                </button>
                <button class="quick-function-btn p-4 rounded-lg border-2 border-gray-200 hover:border-purple-300 hover:bg-purple-50 transition-all duration-200 text-center group" onclick="window.location.href='learning-path-generator.html'">
                    <i class="fas fa-route text-3xl text-purple-500 mb-3 group-hover:scale-110 transition-transform"></i>
                    <div class="text-base font-medium text-gray-700">å­¦ä¹ è·¯å¾„ç”Ÿæˆå™¨</div>
                </button>
            </div>
            
            <!-- åŠŸèƒ½çŠ¶æ€æç¤º -->
            <div id="function-status" class="mt-4 p-3 bg-green-50 border border-green-200 rounded-lg text-sm text-green-700 hidden">
                <i class="fas fa-check-circle mr-2"></i>
                <span id="status-text"></span>
            </div>
            
            <!-- è®¡ç®—å™¨ç»„ä»¶ -->
            <div id="calculator" class="mt-4 bg-gray-50 rounded-lg p-4 hidden">
                <div class="bg-white rounded-lg p-3 mb-3">
                    <input type="text" id="calc-display" class="w-full text-right text-lg font-mono bg-transparent border-none focus:outline-none" value="0" readonly>
                </div>
                <div class="grid grid-cols-4 gap-2">
                    <button class="calc-btn bg-gray-200 hover:bg-gray-300 p-3 rounded text-center font-semibold" onclick="clearCalculator()">C</button>
                    <button class="calc-btn bg-gray-200 hover:bg-gray-300 p-3 rounded text-center font-semibold" onclick="deleteLast()">âŒ«</button>
                    <button class="calc-btn bg-orange-200 hover:bg-orange-300 p-3 rounded text-center font-semibold" onclick="appendToDisplay('/')">/</button>
                    <button class="calc-btn bg-orange-200 hover:bg-orange-300 p-3 rounded text-center font-semibold" onclick="appendToDisplay('*')">Ã—</button>
                    
                    <button class="calc-btn bg-white hover:bg-gray-100 p-3 rounded text-center font-semibold" onclick="appendToDisplay('7')">7</button>
                    <button class="calc-btn bg-white hover:bg-gray-100 p-3 rounded text-center font-semibold" onclick="appendToDisplay('8')">8</button>
                    <button class="calc-btn bg-white hover:bg-gray-100 p-3 rounded text-center font-semibold" onclick="appendToDisplay('9')">9</button>
                    <button class="calc-btn bg-orange-200 hover:bg-orange-300 p-3 rounded text-center font-semibold" onclick="appendToDisplay('-')">-</button>
                    
                    <button class="calc-btn bg-white hover:bg-gray-100 p-3 rounded text-center font-semibold" onclick="appendToDisplay('4')">4</button>
                    <button class="calc-btn bg-white hover:bg-gray-100 p-3 rounded text-center font-semibold" onclick="appendToDisplay('5')">5</button>
                    <button class="calc-btn bg-white hover:bg-gray-100 p-3 rounded text-center font-semibold" onclick="appendToDisplay('6')">6</button>
                    <button class="calc-btn bg-orange-200 hover:bg-orange-300 p-3 rounded text-center font-semibold" onclick="appendToDisplay('+')">+</button>
                    
                    <button class="calc-btn bg-white hover:bg-gray-100 p-3 rounded text-center font-semibold" onclick="appendToDisplay('1')">1</button>
                    <button class="calc-btn bg-white hover:bg-gray-100 p-3 rounded text-center font-semibold" onclick="appendToDisplay('2')">2</button>
                    <button class="calc-btn bg-white hover:bg-gray-100 p-3 rounded text-center font-semibold" onclick="appendToDisplay('3')">3</button>
                    <button class="calc-btn bg-blue-500 hover:bg-blue-600 text-white p-3 rounded text-center font-semibold row-span-2" onclick="calculate()" style="grid-row: span 2;">=</button>
                    
                    <button class="calc-btn bg-white hover:bg-gray-100 p-3 rounded text-center font-semibold" onclick="appendToDisplay('0')" style="grid-column: span 2;">0</button>
                    <button class="calc-btn bg-white hover:bg-gray-100 p-3 rounded text-center font-semibold" onclick="appendToDisplay('.')">.</button>
                </div>
            </div>
        </div>


        </div>
        </div>
    </div>
    
    <!-- åº•éƒ¨æ¨ªå¹…å¹¿å‘Šä½ -->
    <div class="bg-white border-t border-gray-200 py-4 mt-8">
        <div class="container mx-auto px-4">
            <div class="flex justify-center">
                <div id="bottom-banner-ad" class="bg-gradient-to-r from-green-50 to-blue-50 rounded-lg p-3 border border-green-200 max-w-5xl w-full text-center ad-hover">
                    <!-- è…¾è®¯å¹¿ç‚¹é€šå¹¿å‘Šä»£ç ä½ç½® -->
                    <script type="text/javascript">
                        // è…¾è®¯å¹¿ç‚¹é€šå¹¿å‘Šä»£ç 
                        /*
                        (function() {
                            var gdt_ad_id = "your_gdt_ad_id"; // æ›¿æ¢ä¸ºå®é™…çš„å¹¿ç‚¹é€šID
                            var gdt_ad_w = 970;
                            var gdt_ad_h = 200;
                            var s = document.createElement("script");
                            s.type = "text/javascript";
                            s.src = "//vm.gtimg.cn/tencentvideo/txp/js/txplayer.js";
                            document.getElementsByTagName("head")[0].appendChild(s);
                        })();
                        */
                    </script>
                    <!-- ä¸´æ—¶å ä½å†…å®¹ -->
                    <div class="text-gray-600 py-2">
                        <i class="fas fa-book-open text-xl mb-2 text-green-600"></i>
                        <h3 class="text-lg font-bold mb-2 text-gray-800">ğŸ“ ä¸“ä¸šè€ƒç ”è¾…å¯¼ | åå¸ˆåœ¨çº¿æˆè¯¾ | é«˜æ•ˆæåˆ†æ–¹æ¡ˆ</h3>
                        <p class="text-sm mb-2">ğŸ’¡ ä¸ªæ€§åŒ–å­¦ä¹ è®¡åˆ’ | ğŸ“š æµ·é‡é¢˜åº“èµ„æº | ğŸ† å†å¹´é«˜åˆ†å­¦å‘˜æ¨è</p>
                        <button class="bg-gradient-to-r from-blue-500 to-green-500 text-white px-4 py-1.5 rounded-full hover:from-blue-600 hover:to-green-600 transition-all duration-300 shadow-lg text-sm">
                            ç«‹å³äº†è§£è¯¾ç¨‹ â†’
                        </button>
                        <p class="text-xs mt-2 text-gray-400">970x200 è…¾è®¯å¹¿ç‚¹é€š</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- å³ä¾§æ‚¬æµ®å¹¿å‘Šä½ -->
    <div class="fixed right-4 top-1/2 transform -translate-y-1/2 z-30">
        <div id="sidebar-ad" class="bg-white rounded-lg shadow-xl border border-gray-200 p-2 w-36 hover:shadow-2xl transition-shadow duration-300 ad-hover">
            <!-- ä»Šæ—¥å¤´æ¡ç©¿å±±ç”²å¹¿å‘Šä»£ç ä½ç½® -->
            <script type="text/javascript">
                // ä»Šæ—¥å¤´æ¡ç©¿å±±ç”²å¹¿å‘Šä»£ç 
                /*
                (function() {
                    var tt_ad_id = "your_tt_ad_id"; // æ›¿æ¢ä¸ºå®é™…çš„ç©¿å±±ç”²ID
                    var tt_ad_w = 140;
                    var tt_ad_h = 280;
                    var s = document.createElement("script");
                    s.type = "text/javascript";
                    s.src = "//sf1-cdn-tos.pstatp.com/goofy/ttzz/push.js";
                    document.getElementsByTagName("head")[0].appendChild(s);
                })();
                */
            </script>
            <!-- ä¸´æ—¶å ä½å†…å®¹ -->
            <div class="text-center text-gray-500 py-4">
                <i class="fas fa-laptop-code text-2xl mb-2 block text-purple-500"></i>
                <p class="text-xs font-medium mb-2">ğŸ’» ç¼–ç¨‹åŸ¹è®­</p>
                <p class="text-xs mb-2">ğŸ”¥ çƒ­é—¨è¯¾ç¨‹</p>
                <p class="text-xs mb-2">â­ åå¸ˆæˆè¯¾</p>
                <p class="text-xs opacity-70">140x280 å¹¿å‘Šä½</p>
            </div>
        </div>
    </div>
    
    <footer class="text-center w-full text-gray-500 text-sm py-4">
        <p>ç”±ä¸€ä¸ªçˆ±å­¦ä¹ çš„å­¦é•¿å¼€å‘</p>
    </footer>
    
    <script>
        // AIä¸ªæ€§åŒ–å­¦ä¹ è·¯å¾„ç”Ÿæˆå™¨ç›¸å…³å‡½æ•°å·²åˆ é™¤
        
        // æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯
         function showErrorMessage(message) {
             const errorDiv = document.createElement('div');
             errorDiv.className = 'notification error';
             errorDiv.innerHTML = `
                 <i class="fas fa-exclamation-triangle"></i>
                 <span>${message}</span>
                 <button class="close-btn" onclick="this.parentElement.remove()">
                     <i class="fas fa-times"></i>
                 </button>
             `;
             document.body.appendChild(errorDiv);
             
             // è‡ªåŠ¨ç§»é™¤
             setTimeout(() => {
                 if (errorDiv.parentNode) {
                     errorDiv.remove();
                 }
             }, 5000);
         }
         
         // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
         function showSuccessMessage(message) {
             const successDiv = document.createElement('div');
             successDiv.className = 'notification success';
             successDiv.innerHTML = `
                 <i class="fas fa-check-circle"></i>
                 <span>${message}</span>
                 <button class="close-btn" onclick="this.parentElement.remove()">
                     <i class="fas fa-times"></i>
                 </button>
             `;
             document.body.appendChild(successDiv);
             
             // è‡ªåŠ¨ç§»é™¤
             setTimeout(() => {
                 if (successDiv.parentNode) {
                     successDiv.remove();
                 }
             }, 3000);
         }
        
        // generateLearningPathå‡½æ•°å·²åˆ é™¤
        
        // generatePathContentFromAPIå‡½æ•°å·²åˆ é™¤
        
        // æ‰€æœ‰å­¦ä¹ è·¯å¾„ç›¸å…³å‡½æ•°å·²åˆ é™¤
        
        // å­¦ä¹ è·¯å¾„ç›¸å…³å‡½æ•°å·²å…¨éƒ¨åˆ é™¤
        
        // ========== å­¦ä¹ å·¥å…·åŠŸèƒ½ ==========
        
        // è®¡æ—¶å™¨ç›¸å…³å˜é‡
        let timerInterval = null;
        let timerSeconds = 0;
        let totalStudySeconds = 0;
        let questionCount = 0;
        
        // åˆå§‹åŒ–å­¦ä¹ å·¥å…·
        function initLearningTools() {
            // åŠ è½½ä¿å­˜çš„æ•°æ®
            loadStudyData();
        }
        
        // æ›´æ–°è®¡æ—¶å™¨æ˜¾ç¤º
        function updateTimerDisplay() {
            const hours = Math.floor(timerSeconds / 3600);
            const minutes = Math.floor((timerSeconds % 3600) / 60);
            const seconds = timerSeconds % 60;
            
            const display = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            document.getElementById('timer-display').textContent = display;
        }
        
        // æ›´æ–°å­¦ä¹ ç»Ÿè®¡
        function updateStudyStats() {
            const minutes = Math.floor(totalStudySeconds / 60);
            document.getElementById('total-study-time').textContent = `${minutes}åˆ†é’Ÿ`;
            document.getElementById('question-count').textContent = `${questionCount}æ¬¡`;
            
            // è¿›åº¦æ¡ç°åœ¨ç”±å­¦ä¹ è®¡æ—¶å™¨åŠŸèƒ½æ§åˆ¶ï¼Œä¸åœ¨è¿™é‡Œæ›´æ–°
        }
        

        
        // ä¿å­˜å­¦ä¹ æ•°æ®
        function saveStudyData() {
            const data = {
                totalStudySeconds: totalStudySeconds,
                questionCount: questionCount,
                date: new Date().toDateString()
            };
            localStorage.setItem('studyData', JSON.stringify(data));
        }
        
        // åŠ è½½å­¦ä¹ æ•°æ®
        function loadStudyData() {
            const saved = localStorage.getItem('studyData');
            if (saved) {
                const data = JSON.parse(saved);
                const today = new Date().toDateString();
                
                // å¦‚æœæ˜¯ä»Šå¤©çš„æ•°æ®ï¼Œåˆ™åŠ è½½
                if (data.date === today) {
                    totalStudySeconds = data.totalStudySeconds || 0;
                    questionCount = data.questionCount || 0;
                } else {
                    // æ–°çš„ä¸€å¤©ï¼Œé‡ç½®æ•°æ®
                    totalStudySeconds = 0;
                    questionCount = 0;
                }
            }
        }
        
        // æ›´æ–°æ˜¾ç¤º
        function updateDisplay() {
            updateStudyStats();
            updateTimerDisplay();
        }
        
        // å¢åŠ æé—®æ¬¡æ•°
        function incrementQuestionCount() {
            questionCount++;
            updateStudyStats();
            saveStudyData();
        }
        
        // ========== èŠå¤©åŠŸèƒ½ ==========
        
        // å¤„ç†é”®ç›˜æŒ‰é”®äº‹ä»¶
        function handleChatKeyPress(event) {
            if (event.key === 'Enter') {
                sendChatMessage();
            }
        }
        
        // å‘é€èŠå¤©æ¶ˆæ¯
        async function sendChatMessage() {
            const chatInput = document.getElementById('chatInput');
            const message = chatInput.value.trim();
            
            if (!message) {
                showErrorMessage('è¯·è¾“å…¥æ‚¨çš„é—®é¢˜');
                return;
            }
            
            // æ¸…ç©ºè¾“å…¥æ¡†
            chatInput.value = '';
            
            // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯åˆ°èŠå¤©åŒºåŸŸ
            addMessageToChat(message, 'user');
            
            // å¢åŠ æé—®æ¬¡æ•°ç»Ÿè®¡
            incrementQuestionCount();
            
            // æ˜¾ç¤ºAIæ­£åœ¨æ€è€ƒçš„çŠ¶æ€
            const thinkingMessageId = addThinkingMessage();
            
            // æ ¹æ®æ¿€æ´»çš„åŠŸèƒ½è°ƒæ•´æ¶ˆæ¯å†…å®¹
            let processedMessage = message;
            if (activeFunction === 'translator') {
                processedMessage = `è¯·å¸®æˆ‘ç¿»è¯‘ä»¥ä¸‹æ–‡æœ¬ï¼Œå¹¶è¯¦ç»†åˆ†æå…¶ä¸­çš„ç”Ÿè¯ã€éš¾è¯ã€è¯­æ³•ç»“æ„å’Œè¡¨è¾¾æŠ€å·§ï¼š\n\n${message}`;
            } else if (activeFunction === 'creative') {
                processedMessage = `è¯·æ ¹æ®ä»¥ä¸‹æ–‡æœ¬è¿›è¡Œåˆ›æ„åˆ›ä½œï¼Œå¯ä»¥æ˜¯ç»­å†™ã€æ”¹å†™ã€æˆ–è€…åŸºäºæ­¤ä¸»é¢˜çš„åˆ›æ„å‘æŒ¥ï¼š\n\n${message}`;
            }
            
            try {
                // è°ƒç”¨DeepSeek AI API
                const response = await fetch('http://localhost:5000/chat_with_deepseek', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        message: processedMessage
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`æœåŠ¡å™¨é”™è¯¯ (${response.status})`);
                }
                
                const data = await response.json();
                
                // ç§»é™¤æ€è€ƒçŠ¶æ€æ¶ˆæ¯
                removeThinkingMessage(thinkingMessageId);
                
                if (data.success) {
                    // æ·»åŠ AIå›å¤åˆ°èŠå¤©åŒºåŸŸ
                    addMessageToChat(data.reply, 'ai');
                } else {
                    throw new Error(data.error || 'è·å–AIå›å¤å¤±è´¥');
                }
                
            } catch (error) {
                // ç§»é™¤æ€è€ƒçŠ¶æ€æ¶ˆæ¯
                removeThinkingMessage(thinkingMessageId);
                
                console.error('èŠå¤©é”™è¯¯:', error);
                
                let errorMessage = 'æŠ±æ­‰ï¼Œæˆ‘ç°åœ¨æ— æ³•å›ç­”æ‚¨çš„é—®é¢˜ã€‚';
                if (error.name === 'AbortError') {
                    errorMessage = 'è¯·æ±‚è¶…æ—¶ï¼Œè¯·ç¨åå†è¯•ã€‚';
                } else if (error.message.includes('Failed to fetch')) {
                    errorMessage = 'ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥ã€‚';
                }
                
                addMessageToChat(errorMessage, 'ai');
                showErrorMessage('å‘é€æ¶ˆæ¯å¤±è´¥: ' + error.message);
            }
        }
        
        // æ·»åŠ æ¶ˆæ¯åˆ°èŠå¤©åŒºåŸŸ
        function addMessageToChat(message, sender) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `flex mb-4 ${sender === 'user' ? 'justify-end' : ''}`;
            
            if (sender === 'user') {
                messageDiv.innerHTML = `
                    <div class="max-w-xs md:max-w-md">
                        <div class="user-message bg-blue-500 text-white p-3 rounded-lg">
                            <p>${escapeHtml(message)}</p>
                        </div>
                    </div>
                    <div class="w-8 h-8 rounded-full bg-blue-500 flex items-center justify-center text-white ml-2">
                        <i class="fas fa-user"></i>
                    </div>
                `;
            } else {
                messageDiv.innerHTML = `
                    <div class="w-8 h-8 rounded-full bg-blue-500 flex items-center justify-center text-white mr-2">
                        <img src="qwen_image_138532ba_20250908_214559.png" alt="AIåŠ©æ‰‹" class="w-6 h-6 rounded-full">
                    </div>
                    <div class="max-w-xs md:max-w-md">
                        <div class="ai-message p-3">
                            <p>${formatAIMessage(message)}</p>
                        </div>
                    </div>
                `;
            }
            
            chatMessages.appendChild(messageDiv);
            
            // é‡æ–°æ¸²æŸ“æ•°å­¦å…¬å¼
            if (window.MathJax && window.MathJax.typesetPromise) {
                window.MathJax.typesetPromise([messageDiv]).catch((err) => console.log('MathJax typeset failed: ' + err.message));
            }
            
            // æ»šåŠ¨åˆ°åº•éƒ¨
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }
        
        // æ·»åŠ AIæ€è€ƒçŠ¶æ€æ¶ˆæ¯
        function addThinkingMessage() {
            const chatMessages = document.getElementById('chatMessages');
            const thinkingDiv = document.createElement('div');
            const thinkingId = 'thinking-' + Date.now();
            thinkingDiv.id = thinkingId;
            thinkingDiv.className = 'flex mb-4';
            thinkingDiv.innerHTML = `
                <div class="w-8 h-8 rounded-full bg-blue-500 flex items-center justify-center text-white mr-2">
                    <img src="assets/cute_dog_anime.png" alt="AIåŠ©æ‰‹" class="w-6 h-6 rounded-full">
                </div>
                <div class="max-w-xs md:max-w-md">
                    <div class="ai-message p-3">
                        <p class="flex items-center">
                            <i class="fas fa-spinner fa-spin mr-2"></i>
                            æ­£åœ¨æ€è€ƒä¸­...
                        </p>
                    </div>
                </div>
            `;
            
            chatMessages.appendChild(thinkingDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            return thinkingId;
        }
        
        // ç§»é™¤AIæ€è€ƒçŠ¶æ€æ¶ˆæ¯
        function removeThinkingMessage(thinkingId) {
            const thinkingDiv = document.getElementById(thinkingId);
            if (thinkingDiv) {
                thinkingDiv.remove();
            }
        }
        
        // HTMLè½¬ä¹‰å‡½æ•°
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        // æ ¼å¼åŒ–AIæ¶ˆæ¯ï¼ˆæ”¯æŒç®€å•çš„markdownï¼‰
        function formatAIMessage(message) {
            // ä¿æŠ¤æ•°å­¦å…¬å¼ä¸è¢«è½¬ä¹‰
            const mathPlaceholders = [];
            let formatted = message;
            
            // ä¸´æ—¶æ›¿æ¢æ•°å­¦å…¬å¼
            formatted = formatted.replace(/\\\[(.*?)\\\]/gs, (match, content) => {
                const placeholder = `__MATH_DISPLAY_${mathPlaceholders.length}__`;
                mathPlaceholders.push(match);
                return placeholder;
            });
            
            formatted = formatted.replace(/\\\((.*?)\\\)/gs, (match, content) => {
                const placeholder = `__MATH_INLINE_${mathPlaceholders.length}__`;
                mathPlaceholders.push(match);
                return placeholder;
            });
            
            // è½¬ä¹‰HTMLï¼ˆé™¤äº†æ•°å­¦å…¬å¼ï¼‰
            formatted = escapeHtml(formatted);
            
            // æ¢å¤æ•°å­¦å…¬å¼
            mathPlaceholders.forEach((math, index) => {
                if (math.startsWith('\\[')) {
                    formatted = formatted.replace(`__MATH_DISPLAY_${index}__`, math);
                } else {
                    formatted = formatted.replace(`__MATH_INLINE_${index}__`, math);
                }
            });
            
            // ç®€å•çš„markdownæ”¯æŒ
            formatted = formatted.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>'); // ç²—ä½“
            formatted = formatted.replace(/\*(.*?)\*/g, '<em>$1</em>'); // æ–œä½“
            formatted = formatted.replace(/`(.*?)`/g, '<code class="bg-gray-100 px-1 rounded">$1</code>'); // ä»£ç 
            formatted = formatted.replace(/\n/g, '<br>'); // æ¢è¡Œ
            
            return formatted;
        }
        
        // æ·»åŠ æ¶ˆæ¯å‡½æ•°ï¼ˆä¾›å¿«é€ŸåŠŸèƒ½ä½¿ç”¨ï¼‰
        function addMessage(sender, message) {
            addMessageToChat(message, sender);
        }
        
        // å­¦ä¹ è®¡æ—¶å™¨åŠŸèƒ½
        let studyTimer = null;
        let totalSeconds = 0;
        let remainingSeconds = 0;
        let isTimerRunning = false;
        
        function initStudyTimer() {
            const hoursSelect = document.getElementById('hours');
            const minutesSelect = document.getElementById('minutes');
            const startButton = document.getElementById('start-timer');
            const pauseButton = document.getElementById('pause-timer');
            const resetButton = document.getElementById('reset-timer');
            const timerDisplay = document.getElementById('timer-display');
            const timerStatus = document.getElementById('timer-status');
            const progressBar = document.getElementById('progress-bar');
            
            // ä»æœ¬åœ°å­˜å‚¨åŠ è½½è®¾ç½®
            const savedHours = localStorage.getItem('studyHours') || '0';
            const savedMinutes = localStorage.getItem('studyMinutes') || '0';
            hoursSelect.value = savedHours;
            minutesSelect.value = savedMinutes;
            
            // ä¿å­˜è®¾ç½®åˆ°æœ¬åœ°å­˜å‚¨
            hoursSelect.addEventListener('change', function() {
                localStorage.setItem('studyHours', this.value);
            });
            
            minutesSelect.addEventListener('change', function() {
                localStorage.setItem('studyMinutes', this.value);
            });
            
            startButton.addEventListener('click', function() {
                if (!isTimerRunning) {
                    startStudyTimer();
                } else {
                    stopStudyTimer();
                }
            });
            
            pauseButton.addEventListener('click', function() {
                if (isTimerRunning) {
                    pauseStudyTimer();
                }
            });
            
            resetButton.addEventListener('click', function() {
                resetStudyTimer();
            });
            
            // åˆå§‹åŒ–æŒ‰é’®çŠ¶æ€
            pauseButton.style.opacity = '0.5';
            pauseButton.disabled = true;
            
            function startStudyTimer() {
                const hours = parseInt(hoursSelect.value);
                const minutes = parseInt(minutesSelect.value);
                
                if (hours === 0 && minutes === 0) {
                    alert('è¯·è®¾ç½®å­¦ä¹ æ—¶é—´ï¼');
                    return;
                }
                
                if (remainingSeconds === 0) {
                    totalSeconds = hours * 3600 + minutes * 60;
                    remainingSeconds = totalSeconds;
                }
                
                isTimerRunning = true;
                
                startButton.innerHTML = '<i class="fas fa-stop mr-1"></i>åœæ­¢';
                startButton.classList.remove('bg-purple-500', 'hover:bg-purple-600');
                startButton.classList.add('bg-red-500', 'hover:bg-red-600');
                pauseButton.style.opacity = '1';
                pauseButton.disabled = false;
                timerStatus.textContent = 'å­¦ä¹ ä¸­';
                
                studyTimer = setInterval(function() {
                    remainingSeconds--;
                    updateDisplay();
                    
                    if (remainingSeconds <= 0) {
                        completeTimer();
                    }
                }, 1000);
            }
            
            function pauseStudyTimer() {
                clearInterval(studyTimer);
                isTimerRunning = false;
                
                startButton.innerHTML = '<i class="fas fa-play mr-1"></i>ç»§ç»­';
                startButton.classList.remove('bg-red-500', 'hover:bg-red-600');
                startButton.classList.add('bg-green-500', 'hover:bg-green-600');
                pauseButton.style.opacity = '0.5';
                pauseButton.disabled = true;
                timerStatus.textContent = 'å·²æš‚åœ';
            }
            
            function stopStudyTimer() {
                clearInterval(studyTimer);
                isTimerRunning = false;
                
                // è®¡ç®—å®é™…å­¦ä¹ æ—¶é•¿ï¼ˆæ€»æ—¶é•¿ - å‰©ä½™æ—¶é•¿ï¼‰
                const studiedSeconds = totalSeconds - remainingSeconds;
                
                remainingSeconds = 0;
                
                startButton.innerHTML = '<i class="fas fa-play mr-1"></i>å¼€å§‹';
                startButton.classList.remove('bg-red-500', 'hover:bg-red-600', 'bg-green-500', 'hover:bg-green-600');
                startButton.classList.add('bg-purple-500', 'hover:bg-purple-600');
                pauseButton.style.opacity = '0.5';
                pauseButton.disabled = true;
                timerStatus.textContent = 'å·²åœæ­¢';
                
                // åŒæ­¥å­¦ä¹ æ—¶é•¿åˆ°åç«¯ï¼ˆåªæœ‰å­¦ä¹ æ—¶é—´å¤§äº30ç§’æ‰è®°å½•ï¼‰
                if (studiedSeconds > 30) {
                    syncStudyTimeToBackend(studiedSeconds);
                }
            }
            
            function resetStudyTimer() {
                clearInterval(studyTimer);
                isTimerRunning = false;
                remainingSeconds = 0;
                
                startButton.innerHTML = '<i class="fas fa-play mr-1"></i>å¼€å§‹';
                startButton.classList.remove('bg-red-500', 'hover:bg-red-600', 'bg-green-500', 'hover:bg-green-600');
                startButton.classList.add('bg-purple-500', 'hover:bg-purple-600');
                pauseButton.style.opacity = '0.5';
                pauseButton.disabled = true;
                timerStatus.textContent = 'å‡†å¤‡å¼€å§‹';
                updateDisplay();
            }
            
            function completeTimer() {
                clearInterval(studyTimer);
                isTimerRunning = false;
                
                // è®¡ç®—å®é™…å­¦ä¹ æ—¶é•¿ï¼ˆæ€»æ—¶é•¿ - å‰©ä½™æ—¶é•¿ï¼‰
                const studiedSeconds = totalSeconds - remainingSeconds;
                
                remainingSeconds = 0;
                
                startButton.innerHTML = '<i class="fas fa-play mr-1"></i>å¼€å§‹';
                startButton.classList.remove('bg-red-500', 'hover:bg-red-600', 'bg-green-500', 'hover:bg-green-600');
                startButton.classList.add('bg-purple-500', 'hover:bg-purple-600');
                pauseButton.style.opacity = '0.5';
                pauseButton.disabled = true;
                timerStatus.textContent = 'å·²å®Œæˆ';
                
                // åŒæ­¥å­¦ä¹ æ—¶é•¿åˆ°åç«¯
                if (studiedSeconds > 0) {
                    syncStudyTimeToBackend(studiedSeconds);
                }
                
                // æ˜¾ç¤ºå¯çˆ±çš„å®Œæˆæç¤º
                showCompletionMessage();
            }
            
            function showCompletionMessage() {
                // åˆ›å»ºå®Œæˆæç¤ºè¦†ç›–å±‚
                const overlay = document.createElement('div');
                overlay.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
                overlay.innerHTML = `
                    <div class="bg-white rounded-lg p-8 text-center max-w-md mx-4 animate-bounce">
                        <div class="text-6xl mb-4">ğŸ‰</div>
                        <h2 class="text-2xl font-bold text-purple-600 mb-2">ä»»åŠ¡å®Œæˆå•¦ï¼</h2>
                        <p class="text-gray-600 mb-4">ä»Šå¤©ä¹Ÿæ˜¯å¥½å¥½å­¦ä¹ çš„ä¸€å¤©å“¦ï½</p>
                        <div class="flex justify-center space-x-2 mb-4">
                            <span class="text-2xl">âœ¨</span>
                            <span class="text-2xl">ğŸŒŸ</span>
                            <span class="text-2xl">ğŸ’–</span>
                        </div>
                        <button onclick="this.parentElement.parentElement.remove()" 
                                class="px-6 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors">
                            ç»§ç»­åŠ æ²¹ï¼
                        </button>
                    </div>
                `;
                
                document.body.appendChild(overlay);
                
                // 3ç§’åè‡ªåŠ¨æ¶ˆå¤±
                setTimeout(() => {
                    if (overlay.parentElement) {
                        overlay.remove();
                    }
                }, 5000);
            }
            
            function updateDisplay() {
                const hours = Math.floor(remainingSeconds / 3600);
                const minutes = Math.floor((remainingSeconds % 3600) / 60);
                const seconds = remainingSeconds % 60;
                
                timerDisplay.textContent = 
                    String(hours).padStart(2, '0') + ':' +
                    String(minutes).padStart(2, '0') + ':' +
                    String(seconds).padStart(2, '0');
                
                // æ›´æ–°è¿›åº¦æ¡
                const progress = totalSeconds > 0 ? ((totalSeconds - remainingSeconds) / totalSeconds) * 100 : 0;
                progressBar.style.width = progress + '%';
            }
            
            // åŒæ­¥å­¦ä¹ æ—¶é•¿åˆ°åç«¯
            async function syncStudyTimeToBackend(duration) {
                try {
                    const token = localStorage.getItem('token');
                    if (!token) {
                        console.log('ç”¨æˆ·æœªç™»å½•ï¼Œæ— æ³•åŒæ­¥å­¦ä¹ æ—¶é•¿');
                        return;
                    }
                    
                    const response = await fetch('http://localhost:5000/study-time', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${token}`
                        },
                        body: JSON.stringify({
                            duration: duration,
                            session_type: 'study'
                        })
                    });
                    
                    if (response.ok) {
                        const result = await response.json();
                        console.log('å­¦ä¹ æ—¶é•¿åŒæ­¥æˆåŠŸ:', result);
                        
                        // æ˜¾ç¤ºåŒæ­¥æˆåŠŸçš„æç¤º
                        showSyncSuccessMessage(duration, result.total_study_time);
                    } else {
                        console.error('å­¦ä¹ æ—¶é•¿åŒæ­¥å¤±è´¥:', response.statusText);
                    }
                } catch (error) {
                    console.error('å­¦ä¹ æ—¶é•¿åŒæ­¥å‡ºé”™:', error);
                }
            }
            
            // æ˜¾ç¤ºåŒæ­¥æˆåŠŸçš„æ¶ˆæ¯
            function showSyncSuccessMessage(duration, totalTime) {
                const hours = Math.floor(duration / 3600);
                const minutes = Math.floor((duration % 3600) / 60);
                const totalHours = Math.floor(totalTime / 3600);
                const totalMinutes = Math.floor((totalTime % 3600) / 60);
                
                const message = document.createElement('div');
                message.className = 'fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50 animate-pulse';
                message.innerHTML = `
                    <div class="flex items-center">
                        <span class="text-lg mr-2">âœ…</span>
                        <div>
                            <div class="font-semibold">å­¦ä¹ è®°å½•å·²ä¿å­˜ï¼</div>
                            <div class="text-sm">æœ¬æ¬¡: ${hours}h ${minutes}m | æ€»è®¡: ${totalHours}h ${totalMinutes}m</div>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(message);
                
                // 3ç§’åè‡ªåŠ¨æ¶ˆå¤±
                setTimeout(() => {
                    if (message.parentElement) {
                        message.remove();
                    }
                }, 3000);
            }
        }
        
        // å¿«é€ŸåŠŸèƒ½ç®¡ç†
        let activeFunction = null;
        
        function initQuickFunctions() {
            const functionButtons = document.querySelectorAll('.quick-function-btn');
            const functionStatus = document.getElementById('function-status');
            const statusText = document.getElementById('status-text');
            const calculator = document.getElementById('calculator');
            
            functionButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const functionType = this.getAttribute('data-function');
                    
                    // é‡ç½®æ‰€æœ‰æŒ‰é’®çŠ¶æ€
                    functionButtons.forEach(btn => {
                        btn.classList.remove('border-green-500', 'bg-green-100');
                        btn.classList.add('border-gray-200');
                    });
                    
                    // éšè—è®¡ç®—å™¨
                    calculator.classList.add('hidden');
                    
                    if (activeFunction === functionType) {
                        // å–æ¶ˆæ¿€æ´»
                        activeFunction = null;
                        functionStatus.classList.add('hidden');
                    } else {
                        // æ¿€æ´»æ–°åŠŸèƒ½
                        activeFunction = functionType;
                        this.classList.remove('border-gray-200');
                        this.classList.add('border-green-500', 'bg-green-100');
                        
                        // æ˜¾ç¤ºçŠ¶æ€æç¤º
                        const functionNames = {
                            'calculator': 'è®¡ç®—å™¨',
                            'translator': 'ç¿»è¯‘åŠ©æ‰‹',
                            'creative': 'åˆ›æ„çµæ„Ÿ'
                        };
                        
                        statusText.textContent = functionNames[functionType] + 'å·²å¯ç”¨ï¼Œè¯·åœ¨èŠå¤©ç•Œé¢è¾“å…¥æ–‡æœ¬';
                        functionStatus.classList.remove('hidden');
                        
                        // å¦‚æœæ˜¯è®¡ç®—å™¨ï¼Œæ˜¾ç¤ºè®¡ç®—å™¨ç•Œé¢
                        if (functionType === 'calculator') {
                            calculator.classList.remove('hidden');
                            statusText.textContent = 'è®¡ç®—å™¨å·²å¯ç”¨';
                        }
                    }
                });
            });
        }
        
        // è®¡ç®—å™¨åŠŸèƒ½
        function clearCalculator() {
            document.getElementById('calc-display').value = '0';
        }
        
        function deleteLast() {
            const display = document.getElementById('calc-display');
            if (display.value.length > 1) {
                display.value = display.value.slice(0, -1);
            } else {
                display.value = '0';
            }
        }
        
        function appendToDisplay(value) {
            const display = document.getElementById('calc-display');
            if (display.value === '0' && value !== '.') {
                display.value = value;
            } else {
                display.value += value;
            }
        }
        
        function calculate() {
            const display = document.getElementById('calc-display');
            try {
                // æ›¿æ¢æ˜¾ç¤ºçš„ä¹˜å·ä¸ºJavaScriptä¹˜å·
                const expression = display.value.replace(/Ã—/g, '*');
                const result = eval(expression);
                display.value = result;
            } catch (error) {
                display.value = 'Error';
                setTimeout(() => {
                    display.value = '0';
                }, 1500);
            }
        }
        
        // å¾…åŠäº‹é¡¹åŠŸèƒ½
        let todos = JSON.parse(localStorage.getItem('todos')) || [];
        
        function initTodoList() {
            const addBtn = document.getElementById('add-todo-btn');
            const newTodoInput = document.getElementById('new-todo-input');
            const todoList = document.getElementById('todo-list');
            
            // åŠ è½½å·²ä¿å­˜çš„å¾…åŠäº‹é¡¹
            loadTodos();
            
            // æ·»åŠ æ–°ä»»åŠ¡
            addBtn.addEventListener('click', addTodo);
            newTodoInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    addTodo();
                }
            });
            
            function addTodo() {
                const text = newTodoInput.value.trim();
                if (text) {
                    const todo = {
                        id: Date.now(),
                        text: text,
                        completed: false,
                        createdAt: new Date().toISOString()
                    };
                    todos.push(todo);
                    saveTodos();
                    renderTodos();
                    newTodoInput.value = '';
                }
            }
            
            function loadTodos() {
                // åªæ˜¾ç¤ºä»Šå¤©çš„ä»»åŠ¡
                const today = new Date().toDateString();
                todos = todos.filter(todo => {
                    const todoDate = new Date(todo.createdAt).toDateString();
                    return todoDate === today;
                });
                renderTodos();
            }
            
            function renderTodos() {
                // æ¸…é™¤ç¤ºä¾‹ä»»åŠ¡ï¼Œåªåœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶
                if (todos.length > 0) {
                    todoList.innerHTML = '';
                }
                
                todos.forEach(todo => {
                    const todoElement = createTodoElement(todo);
                    if (todos.length > 0 && todoList.children.length === 0) {
                        todoList.innerHTML = '';
                    }
                    todoList.appendChild(todoElement);
                });
                
                updateProgress();
            }
            
            function createTodoElement(todo) {
                const div = document.createElement('div');
                div.className = 'todo-item flex items-center gap-2 p-2 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors';
                div.innerHTML = `
                    <input type="checkbox" class="todo-checkbox w-4 h-4 text-pink-600 bg-gray-100 border-gray-300 rounded focus:ring-pink-500" ${todo.completed ? 'checked' : ''}>
                    <span class="todo-text flex-1 text-sm text-gray-700 ${todo.completed ? 'line-through text-gray-500' : ''}">${todo.text}</span>
                    <button class="delete-todo text-red-500 hover:text-red-700 text-xs">
                        <i class="fas fa-trash"></i>
                    </button>
                `;
                
                // æ·»åŠ äº‹ä»¶ç›‘å¬
                const checkbox = div.querySelector('.todo-checkbox');
                const deleteBtn = div.querySelector('.delete-todo');
                
                checkbox.addEventListener('change', function() {
                    todo.completed = this.checked;
                    const textSpan = div.querySelector('.todo-text');
                    if (this.checked) {
                        textSpan.classList.add('line-through', 'text-gray-500');
                        textSpan.classList.remove('text-gray-700');
                    } else {
                        textSpan.classList.remove('line-through', 'text-gray-500');
                        textSpan.classList.add('text-gray-700');
                    }
                    saveTodos();
                    updateProgress();
                });
                
                deleteBtn.addEventListener('click', function() {
                    todos = todos.filter(t => t.id !== todo.id);
                    saveTodos();
                    div.remove();
                    updateProgress();
                });
                
                return div;
            }
            
            function updateProgress() {
                const total = todos.length;
                const completed = todos.filter(todo => todo.completed).length;
                const progressSpan = document.getElementById('todo-progress');
                progressSpan.textContent = `${completed}/${total} å®Œæˆ`;
                
                // å¦‚æœæ‰€æœ‰ä»»åŠ¡éƒ½å®Œæˆäº†ï¼Œæ˜¾ç¤ºåº†ç¥æ•ˆæœ
                if (total > 0 && completed === total) {
                    progressSpan.innerHTML = `<i class="fas fa-star text-yellow-500 mr-1"></i>${completed}/${total} å®Œæˆï¼`;
                }
            }
            
            function saveTodos() {
                localStorage.setItem('todos', JSON.stringify(todos));
            }
        }
        

        
        function showNotification(message, type = 'success') {
            // ç§»é™¤ç°æœ‰é€šçŸ¥
            const existingNotification = document.querySelector('.notification');
            if (existingNotification) {
                existingNotification.remove();
            }
            
            // åˆ›å»ºæ–°é€šçŸ¥
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <i class="fas ${type === 'success' ? 'fa-check-circle' : 'fa-exclamation-circle'}"></i>
                <span>${message}</span>
                <button class="close-btn" onclick="this.parentElement.remove()">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            document.body.appendChild(notification);
            
            // 3ç§’åè‡ªåŠ¨ç§»é™¤
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 3000);
        }
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initLearningTools();
            initStudyTimer();
            initQuickFunctions();
            initTodoList();
            initAnalytics();
            trackUserBehavior();
        });
    </script>
    
    <!-- ç»Ÿä¸€å¯¼èˆªæ ç®¡ç† -->
    <!-- ç»Ÿä¸€å¯¼èˆªæ ç»„ä»¶ -->
    <script src="js/unified-navbar.js"></script>
    

    
    <!-- ç‰ˆæƒä¿¡æ¯ -->
    <footer class="bg-gray-50 py-4 mt-8">
        <div class="container mx-auto text-center text-gray-600 text-sm">
            <p>Â© 2024 AIå·¥å…·é›†åˆ. ä¿ç•™æ‰€æœ‰æƒåˆ©.</p>
        </div>
    </footer>
</body>
</html>